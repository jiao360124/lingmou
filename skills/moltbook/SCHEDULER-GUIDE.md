# OpenClaw Moltbook Heartbeat - Windows任务计划程序配置指南

## 📋 手动配置步骤

### 步骤1: 打开任务计划程序
```
Win + R → 输入: taskschd.msc → 回车
```

### 步骤2: 创建基本任务
```
1. 右侧点击 "创建基本任务"
2. 输入名称: OpenClaw Moltbook Heartbeat
3. 输入描述: 每天凌晨3点自动检查Moltbook健康状态
4. 点击 "下一步"
```

### 步骤3: 设置触发器
```
1. 选择 "每天"
2. 开始时间: 03:00:00
3. 重复间隔: 1天
4. 重复间隔: 1次
5. 到期: 不限
6. 已启用: ✓
7. 点击 "下一步"
```

### 步骤4: 设置操作
```
1. 选择 "启动程序"
2. 程序或脚本: powershell.exe
3. 添加参数:
   -ExecutionPolicy Bypass -File "C:\Users\Administrator\.openclaw\workspace\scripts\evolution\heartbeat-monitor.ps1"
4. 起始于: C:\Users\Administrator\.opencllaw\workspace
5. 点击 "下一步"
```

### 步骤5: 完成向导
```
1. 完成
2. ✓ 不再做此提示
3. ✓ 如果任务运行失败，按以下方式重新启动: 3次
4. ✓ 重新启动间隔: 1分钟
5. ✓ 如果任务运行失败超过: 72小时
6. ✓ 停止如果任务运行超过: 1天
7. ✓ 只有在计算机使用交流电源时才启动: 否
8. ✓ 唤醒计算机运行任务: 是
9. ✓ 完成向导
```

---

## ✅ 配置后验证

### 1. 检查任务是否存在
```
1. 在任务计划程序中
2. 应该看到 "OpenClaw Moltbook Heartbeat" 任务
3. 右键 → 属性
4. 查看触发器选项卡
   - 应该显示: 每天 03:00:00
5. 查看操作选项卡
   - 应该显示: PowerShell
```

### 2. 手动测试运行
```
1. 在任务计划程序中右键任务
2. 选择 "运行"
3. 查看结果
   - 状态: 就绪
   - 上次运行结果: 成功
```

### 3. 检查日志
```
1. 查看日志文件: logs/heartbeat.log
2. 应该看到今天的检查记录
3. 状态应该是 "健康"
```

---

## 🎯 预期结果

### 任务创建成功后
```
✅ 每天凌晨3:00自动执行
✅ 心跳监控系统启动
✅ Moltbook健康状态检查
✅ 速率限制管理
✅ 日志自动记录
✅ 状态文件更新
```

### 预期输出
```
2026-02-15 03:00:00.000 [INFO] 心跳监控系统启动
2026-02-15 03:00:00.100 [INFO] 配置:
2026-02-15 03:00:00.100 [INFO]   心跳间隔: 30 分钟
2026-02-15 03:00:00.100 [INFO]   警告阈值: 2 次失败
2026-02-15 03:00:00.100 [INFO]   降级阈值: 3 次失败
2026-02-15 03:00:00.100 [INFO] 心跳检查完成
```

---

## 🔧 故障排查

### 任务未运行
```
1. 检查任务状态
   - 右键任务 → 属性
   - "常规"选项卡
   - 检查"已启用"

2. 检查账户权限
   - "常规"选项卡
   - 检查"运行方式"账户
   - 建议使用: Local System

3. 查看错误日志
   - 右键任务 → 运行
   - 查看错误信息
```

### 脚本执行失败
```
1. 测试脚本
   powershell -ExecutionPolicy Bypass -File "C:\Users\Administrator\.openclaw\workspace\scripts\evolution\heartbeat-monitor.ps1"

2. 检查路径
   - 脚本路径是否正确
   - PowerShell是否在PATH中

3. 检查权限
   - 脚本所在目录是否有写入权限
```

---

## 📊 完整检查清单

- [ ] Moltbook API Key已配置
- [ ] Agent名称已更新为AgentX2026
- [ ] 身份验证状态为"已验证"
- [ ] Windows任务计划程序已打开
- [ ] 任务名称为"OpenClaw Moltbook Heartbeat"
- [ ] 触发器设置为每天03:00
- [ ] 操作设置为PowerShell
- [ ] 脚本路径正确
- [ ] 任务已启用
- [ ] 任务测试运行成功
- [ ] 日志文件正常创建
- [ ] 状态文件正常更新

---

## 🎊 配置完成标志

当你看到以下情况时，说明配置成功：

```
✅ 任务计划程序中有"OpenClaw Moltbook Heartbeat"任务
✅ 任务状态显示"就绪"或"运行中"
✅ 下次运行时间显示为明天3:00
✅ 日志文件中有今天的记录
✅ 状态文件中显示健康状态
✅ Moltbook心跳记录正常
```

---

**配置指南版本**: 1.0
**最后更新**: 2026-02-14 23:50:00
**状态**: ✅ 等待手动配置
