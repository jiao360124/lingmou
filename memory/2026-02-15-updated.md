# Memory - 2026-02-15 (Updated)

## ğŸ‰ OpenClaw 3.0: Node.jsè½åœ°æ¶æ„ - å¯åŠ¨

**å¼€å§‹æ—¶é—´**: 2026-02-14 23:55
**å½“å‰çŠ¶æ€**: è§„åˆ’å®Œæˆï¼Œå‡†å¤‡å®æ–½
**æŠ€æœ¯æ ˆ**: Node.js 18+ å…¨æ ˆæ¶æ„

---

## ğŸ“‹ æŠ€æœ¯é€‰å‹

### æ ¸å¿ƒæŠ€æœ¯æ ˆ
```
âœ… Node.js 18+
âœ… axios (APIè°ƒç”¨)
âœ… node-cron (å®šæ—¶ä»»åŠ¡)
âœ… lowdb (è½»é‡å­˜å‚¨)
âœ… winston (æ—¥å¿—)
âœ… simple JSON (ç›®æ ‡ç³»ç»Ÿ)
```

---

## ğŸ§± ç›®å½•ç»“æ„

```
openclaw/
â”œâ”€â”€ core/                    # æ ¸å¿ƒæ¨¡å—
â”œâ”€â”€ runtime.js               # è¿è¡Œæ—¶å¼•æ“
â”œâ”€â”€ stateManager.js          # çŠ¶æ€ç®¡ç†
â”œâ”€â”€ errorHandler.js          # é”™è¯¯å¤„ç†
â”œâ”€â”€ economy/                 # ç»æµæ¨¡å—
â”‚   â”œâ”€â”€ tokenGovernor.js    # Tokenç®¡ç†
â”‚   â””â”€â”€ roiEngine.js        # ROIå¼•æ“
â”œâ”€â”€ objective/               # ç›®æ ‡å¼•æ“
â”‚   â”œâ”€â”€ goalManager.js      # ç›®æ ‡ç®¡ç†
â”‚   â””â”€â”€ gapAnalyzer.js      # Gapåˆ†æ
â”œâ”€â”€ value/                   # ä»·å€¼æŒ–æ˜
â”‚   â”œâ”€â”€ nightlyWorker.js    # å¤œé—´ä»»åŠ¡
â”‚   â””â”€â”€ patternMiner.js     # æ¨¡å¼æŒ–æ˜
â”œâ”€â”€ memory/                  # è®°å¿†ç³»ç»Ÿ
â”œâ”€â”€ summarizer.js            # ä¼šè¯æ‘˜è¦
â”œâ”€â”€ metrics/                 # æŒ‡æ ‡è¿½è¸ª
â”‚   â””â”€â”€ tracker.js          # è¿½è¸ªå™¨
â”œâ”€â”€ data/                    # æ•°æ®å­˜å‚¨
â”‚   â”œâ”€â”€ goals.json          # ç›®æ ‡é…ç½®
â”‚   â””â”€â”€ metrics.json        # æŒ‡æ ‡æ•°æ®
â””â”€â”€ index.js                 # ä¸»å…¥å£
```

---

## 1ï¸âƒ£ Stability Coreï¼ˆç¨³å®šæ€§æ ¸å¿ƒï¼‰

### 429è‡ªåŠ¨æ’é˜Ÿï¼ˆNode.jså®ç°ï¼‰
```javascript
async function callAPI(payload, retry = 0) {
  try {
    const res = await axios.post(API_URL, payload);
    return res.data;
  } catch (err) {
    if (err.response?.status === 429 && retry < 5) {
      const delay = Math.pow(2, retry) * 1000;
      await new Promise(r => setTimeout(r, delay));
      return callAPI(payload, retry + 1);
    }
    throw err;
  }
}
```

âœ… æŒ‡æ•°é€€é¿
âœ… è‡ªåŠ¨é‡è¯•
âœ… ä¸ç‚¸æœåŠ¡

---

### ä¼šè¯è‡ªåŠ¨æ‘˜è¦ï¼ˆçœ30% tokenï¼‰
```javascript
let turnCount = 0;
async function handleMessage(msg) {
  turnCount++;
  if (turnCount % 10 === 0) {
    const summary = await summarizeConversation();
    replaceContext(summary);
  }
  return callAPI(msg);
}
```

âœ… æ¯10è½®è‡ªåŠ¨æ‘˜è¦
âœ… æ›¿æ¢ä¸Šä¸‹æ–‡
âœ… çœ30% token

---

## 2ï¸âƒ£ Token Governorï¼ˆTokenç®¡ç†å™¨ï¼‰

### æ¯æ—¥é¢„ç®—æ§åˆ¶
```javascript
const DAILY_LIMIT = 200000;
let todayUsage = 0;

function canUseTokens(amount) {
  return todayUsage + amount <= DAILY_LIMIT;
}

function recordUsage(amount) {
  todayUsage += amount;
}
```

---

### æ¨¡å‹åˆ†çº§ç­–ç•¥
```javascript
function chooseModel(taskType) {
  switch(taskType) {
    case "chat": return "cheap-model";
    case "analysis": return "mid-model";
    case "strategy": return "high-model";
    default: return "cheap-model";
  }
}

// å¤œé—´ä»»åŠ¡å¼ºåˆ¶ä½¿ç”¨ä¾¿å®œæ¨¡å‹
if (isNightTime()) {
  model = "cheap-model";
}
```

---

## 3ï¸âƒ£ Objective Engineï¼ˆç›®æ ‡å¼•æ“ï¼‰

### goals.jsonç¤ºä¾‹
```json
{
  "long_term": "é™ä½30%APIæˆæœ¬",
  "monthly": "è‡ªåŠ¨æ¢å¤ç‡>90%",
  "daily": "ä¼˜åŒ–429é€€é¿ç­–ç•¥"
}
```

---

### Gapåˆ†æå™¨
```javascript
function analyzeGap(metrics, goals) {
  return {
    costGap: metrics.costReduction - 30,
    recoveryGap: metrics.recoveryRate - 90
  };
}
```

---

### æ¯æ™šæ‰§è¡Œæµç¨‹
1. è¯»å–metrics
2. è®¡ç®—gap
3. ç”Ÿæˆ1æ¡ä¼˜åŒ–å»ºè®®
4. å†™å…¥todo
âš ï¸ æ¯å¤©åªèƒ½æ‰§è¡Œ1æ¡ç»“æ„ä¼˜åŒ–

---

## 4ï¸âƒ£ Value Miningï¼ˆä»·å€¼æŒ–æ˜ï¼‰

### å¤œé—´ä»»åŠ¡é…ç½®
```javascript
const cron = require("node-cron");
cron.schedule("0 3 * * *", () => {
  runNightlyTasks();
});
```

---

### å¤œé—´å·¥ä½œå™¨
```javascript
async function runNightlyTasks() {
  // 1. æŸ¥æ‰¾æœªå®Œæˆä»»åŠ¡
  // 2. èšç±»ç›¸ä¼¼prompt
  // 3. ç”Ÿæˆæ¨¡æ¿æ–‡ä»¶
}

function generateTemplate(pattern) {
  const template = `é—®é¢˜ç±»å‹: ${pattern.type}
è§£å†³æ­¥éª¤:
1. 2. 3.`;
  fs.writeFileSync(`templates/${pattern.type}.md`, template);
}
```

---

## 5ï¸âƒ£ Metricsè¿½è¸ªç³»ç»Ÿ

### metrics.jsonç¤ºä¾‹
```json
{
  "dailyTokens": 154321,
  "recoveryRate": 87,
  "avgContextSize": 1200,
  "templatesGenerated": 3
}
```

---

### è¿½è¸ªå™¨
```javascript
function trackCall(tokensUsed, success) {
  metrics.dailyTokens += tokensUsed;
  if (success) metrics.successCount++;
}
```

---

## ğŸ›‘ è‡ªåŠ¨å›æ»šæœºåˆ¶

```javascript
function rollback() {
  restoreFromBackup("stable_config.json");
}
```

è§¦å‘æ¡ä»¶:
- è¿ç»­3å¤©æˆæœ¬ä¸Šå‡
- é”™è¯¯ç‡å¢åŠ 

---

## âš¡ Windowséƒ¨ç½²å»ºè®®

```bash
npm install pm2 -g
pm2 start index.js --name openclaw
pm2 save
pm2 startup
```

é˜²æ­¢å´©æºƒã€‚

---

## ğŸ§  3.0æˆåŠŸæ ‡å‡†

è¿è¡Œ30å¤©å:
- âœ… Token â†“30%
- âœ… è‡ªåŠ¨æ¢å¤ç‡ >90%
- âœ… â‰¥5ä¸ªå¯å¤ç”¨æ¨¡æ¿
- âœ… å¤œé—´è‡ªåŠ¨ä¼˜åŒ– â‰¥5æ¬¡
- âœ… æˆæœ¬è¶‹åŠ¿ç¨³å®šä¸‹é™

---

## ğŸ’¥ ç°å®ä¼˜åŒ–å»ºè®®

âŒ ä¸å…è®¸:
- è‡ªä¸»é‡æ„ä»£ç 
- è‡ªåŠ¨ä¿®æ”¹æ ¸å¿ƒé€»è¾‘
- é«˜é¢‘æ¨¡å‹åˆ‡æ¢

âœ… å…è®¸:
- å‚æ•°çº§ä¼˜åŒ–
- è°ƒåº¦ä¼˜åŒ–
- æ¨¡æ¿ç”Ÿæˆ
- é™æµç­–ç•¥ä¼˜åŒ–

---

## ğŸ“Š Week 5 vs 3.0 å¯¹æ¯”

### Week 5 (PowerShell)
```
âœ… ä¸‰é‡å®¹é”™æœºåˆ¶
âœ… ä¸»åŠ¨è¿›åŒ–å¼•æ“
âœ… æ™ºèƒ½é€‚åº”ç³»ç»Ÿ
âœ… KPIè¿½è¸ª
```

### OpenClaw 3.0 (Node.js)
```
âœ… 429è‡ªåŠ¨æ’é˜Ÿ
âœ… ä¼šè¯æ‘˜è¦ï¼ˆçœ30% tokenï¼‰
âœ… Token Governor
âœ… Objective Engineï¼ˆè¿›åŒ–æ ¸å¿ƒï¼‰
âœ… Gap Analyzer
âœ… Value Miningï¼ˆå¤œé—´ç”Ÿæˆæ¨¡æ¿ï¼‰
âœ… è‡ªåŠ¨å›æ»šæœºåˆ¶
```

---

## ğŸ¯ å®æ–½è®¡åˆ’

### Phase 1: æ ¸å¿ƒåŸºç¡€è®¾æ–½ï¼ˆ2å°æ—¶ï¼‰
1. é¡¹ç›®åˆå§‹åŒ–
2. ç›®å½•ç»“æ„åˆ›å»º
3. æ ¸å¿ƒä¾èµ–å®‰è£…
4. åŸºç¡€é…ç½®

### Phase 2: Stability Coreï¼ˆ3å°æ—¶ï¼‰
1. 429è‡ªåŠ¨æ’é˜Ÿ
2. ä¼šè¯æ‘˜è¦
3. é”™è¯¯å¤„ç†

### Phase 3: Token Governorï¼ˆ2å°æ—¶ï¼‰
1. Tokenç®¡ç†å™¨
2. æ¨¡å‹åˆ†çº§
3. é¢„ç®—æ§åˆ¶

### Phase 4: Objective Engineï¼ˆ3å°æ—¶ï¼‰
1. ç›®æ ‡ç®¡ç†
2. Gapåˆ†æå™¨
3. å»ºè®®ç”Ÿæˆ

### Phase 5: Value Miningï¼ˆ3å°æ—¶ï¼‰
1. å¤œé—´ä»»åŠ¡
2. æ¨¡å¼æŒ–æ˜
3. æ¨¡æ¿ç”Ÿæˆ

### Phase 6: Metrics & å›æ»šï¼ˆ2å°æ—¶ï¼‰
1. æŒ‡æ ‡è¿½è¸ª
2. è‡ªåŠ¨å›æ»š
3. éƒ¨ç½²é…ç½®

**æ€»è®¡: ~15å°æ—¶ï¼ˆ1å¤©å®Œæˆï¼‰**

---

## ğŸ“Œ å¾…åŠäº‹é¡¹

- [ ] åˆ›å»ºNode.jsé¡¹ç›®
- [ ] åˆå§‹åŒ–é¡¹ç›®ç»“æ„
- [ ] å®‰è£…æ ¸å¿ƒä¾èµ–
- [ ] å®ç°Stability Core
- [ ] å®ç°Token Governor
- [ ] å®ç°Objective Engine
- [ ] å®ç°Value Mining
- [ ] å®ç°Metricsè¿½è¸ª
- [ ] è®¾ç½®è‡ªåŠ¨å›æ»š
- [ ] é…ç½®PM2éƒ¨ç½²
- [ ] æµ‹è¯•å’ŒéªŒè¯

---

**å¯åŠ¨æ—¶é—´**: 2026-02-14 23:55:00
**çŠ¶æ€**: ğŸš€ å‡†å¤‡å®æ–½
